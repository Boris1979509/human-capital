<template>
  <div v-if="$loginStatus && userCanSubscribe">
    <div class="container" v-if="isSubscribed" @click="unsubscribe">
      <div class="icon">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd"
                d="M12.1221 0.478656C12.421 0.0129245 13.0445 -0.124608 13.5147 0.171469L12.9735 1.01475C13.5147 0.171469 13.5147 0.171469 13.5147 0.171469L13.5162 0.172443L13.5182 0.173648L13.523 0.176748L13.5369 0.185687C13.548 0.192852 13.5626 0.202431 13.5804 0.214342C13.6159 0.238138 13.6645 0.271385 13.7231 0.313413C13.8399 0.397133 13.9991 0.517524 14.1765 0.669289C14.5211 0.96405 14.981 1.41642 15.3128 1.9858C15.6448 2.55526 15.8101 3.17555 15.8953 3.61831C15.9392 3.84626 15.9647 4.0429 15.9794 4.18483C15.9868 4.25607 15.9915 4.31431 15.9945 4.35671C15.996 4.37793 15.9971 4.39525 15.9978 4.40831L15.9987 4.42469L15.9989 4.43043L15.999 4.43267L15.9991 4.43407C15.9991 4.43407 15.9991 4.43448 14.9912 4.47629L15.9991 4.43407C16.0224 4.98546 15.59 5.45159 15.0334 5.47468C14.4769 5.49776 14.0069 5.06981 13.9832 4.5187L13.9833 4.52052L13.9832 4.5187L13.9817 4.49578C13.9801 4.47324 13.9772 4.43679 13.9723 4.38901C13.9623 4.29286 13.9444 4.15405 13.9133 3.99245C13.8486 3.65612 13.738 3.28098 13.5655 2.98506C13.3929 2.68905 13.1199 2.40608 12.8578 2.18185C12.7318 2.07412 12.6192 1.9891 12.54 1.93229C12.5006 1.90405 12.4701 1.88324 12.4511 1.87056L12.4319 1.85783L12.4295 1.85628L12.4319 1.85783C11.9619 1.56168 11.8233 0.944279 12.1221 0.478656Z"
                fill="#214EB0"/>
          <path fill-rule="evenodd" clip-rule="evenodd"
                d="M6.1182 9.78549C6.36676 10.1911 6.88016 10.375 7.34289 10.1984C9.15732 9.50593 11.0525 9.36643 12.4063 9.3872C13.1915 9.39924 13.7796 8.91315 14.0632 8.38966C14.348 7.86402 14.4351 7.09051 13.9418 6.44694C13.3516 5.677 12.6888 4.76138 12.2503 4.00891C11.7743 3.19226 11.2492 2.03091 10.844 1.07197C10.544 0.361857 9.87019 0.0328627 9.27146 0.0024049C8.67527 -0.0279242 7.98316 0.226747 7.59925 0.872692C6.92836 2.00146 5.83633 3.59613 4.35486 4.99805L1.74754 6.48909C1.08938 6.86546 0.726297 7.55366 0.738669 8.25651C0.658564 8.27864 0.579938 8.311 0.504591 8.35409C0.0220678 8.63003 -0.143257 9.24117 0.135328 9.71911L1.14417 11.4499C1.42276 11.9278 2.03976 12.0916 2.52228 11.8156C2.59953 11.7715 2.66865 11.7187 2.72912 11.6593C3.16143 11.9129 3.68043 12.0009 4.17936 11.8957C5.06452 13.1995 6.00526 14.1379 6.77231 14.7757C7.2266 15.1534 7.62067 15.4263 7.90759 15.6079C8.05112 15.6988 8.16806 15.767 8.25261 15.8142C8.2949 15.8378 8.32911 15.8562 8.35453 15.8695L8.38598 15.8858L8.3966 15.8912L8.40061 15.8932L8.40228 15.894L8.40373 15.8947C8.40373 15.8947 8.40465 15.8933 8.46034 15.7828C8.91805 14.8741 8.81204 15.0849 8.40373 15.8947C8.5437 15.964 8.69801 16 8.85447 16C10.0615 16 10.9481 15.2188 11.4422 14.6595C11.7078 14.3588 11.9127 14.0629 12.0508 13.8441C12.1205 13.7337 12.1748 13.6402 12.2129 13.5721C12.232 13.5379 12.2471 13.5099 12.2581 13.4892L12.2716 13.4634L12.276 13.4548L12.2777 13.4516L12.2789 13.4491C12.4185 13.1727 12.421 12.8478 12.2858 12.5693C12.1506 12.2907 11.8929 12.0898 11.5878 12.0251C10.5641 11.808 10.052 11.4608 9.81308 11.2404C9.69087 11.1276 9.62829 11.0373 9.60171 10.9935C9.59453 10.9817 9.58977 10.973 9.58706 10.9677C9.40126 10.471 8.85222 10.2014 8.33684 10.363C7.80565 10.5295 7.51135 11.0911 7.67951 11.6172C9.28515 11.1138 7.67924 11.6164 7.68001 11.6188L7.68053 11.6204L7.68159 11.6237L7.68387 11.6306L7.68906 11.6457C7.69281 11.6565 7.69714 11.6684 7.7021 11.6814C7.71204 11.7076 7.72453 11.7382 7.74005 11.7729C7.77111 11.8422 7.81424 11.9275 7.87309 12.0243C7.99126 12.2187 8.17076 12.4563 8.43787 12.7028C8.75391 12.9943 9.17826 13.2853 9.7432 13.5331C9.5047 13.7641 9.27498 13.9092 9.06708 13.9694C9.04424 13.9554 9.01994 13.9403 8.99425 13.924C8.77322 13.7841 8.45052 13.5617 8.06955 13.245C7.3077 12.6115 6.31563 11.6029 5.43471 10.1215C5.29864 9.89265 5.07623 9.72689 4.81657 9.66079C4.55691 9.59468 4.28137 9.63367 4.05078 9.76914L3.75927 9.9404L2.75639 8.21986L4.52496 7.20847L6.06772 9.71119C6.08359 9.73693 6.10044 9.7617 6.1182 9.78549ZM6.16572 6.03511L7.41365 8.05954C9.14909 7.52449 10.8488 7.38848 12.1303 7.38677C11.575 6.65116 10.9514 5.77763 10.5029 5.00809C10.0254 4.18886 9.53119 3.11793 9.14046 2.21278C8.47151 3.29716 7.47733 4.7095 6.16572 6.03511Z"
                fill="#214EB0"/>
          <path
              d="M12.8101 3.47239C13.2291 4.17912 13.1793 4.97859 12.6989 5.25806C12.2184 5.53752 11.4893 5.19116 11.0703 4.48443C10.6513 3.7777 10.7011 2.97823 11.1815 2.69876C11.662 2.4193 12.3911 2.76566 12.8101 3.47239Z"
              fill="#214EB0"/>
        </svg>

      </div>
      <div class="text">
        Слежу за новостями компании
      </div>
    </div>

    <div class="container" v-else @click="subscribe">
      <div class="icon">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd"
                d="M12.1221 0.478656C12.421 0.0129245 13.0445 -0.124608 13.5147 0.171469L12.9735 1.01475C13.5147 0.171469 13.5147 0.171469 13.5147 0.171469L13.5162 0.172443L13.5182 0.173648L13.523 0.176748L13.5369 0.185687C13.548 0.192852 13.5626 0.202431 13.5804 0.214342C13.6159 0.238138 13.6645 0.271385 13.7231 0.313413C13.8399 0.397133 13.9991 0.517524 14.1765 0.669289C14.5211 0.96405 14.981 1.41642 15.3128 1.9858C15.6448 2.55526 15.8101 3.17555 15.8953 3.61831C15.9392 3.84626 15.9647 4.0429 15.9794 4.18483C15.9868 4.25607 15.9915 4.31431 15.9945 4.35671C15.996 4.37793 15.9971 4.39525 15.9978 4.40831L15.9987 4.42469L15.9989 4.43043L15.999 4.43267L15.9991 4.43407C15.9991 4.43407 15.9991 4.43448 14.9912 4.47629L15.9991 4.43407C16.0224 4.98546 15.59 5.45159 15.0334 5.47468C14.4769 5.49776 14.0069 5.06981 13.9832 4.5187L13.9833 4.52052L13.9832 4.5187L13.9817 4.49578C13.9801 4.47324 13.9772 4.43679 13.9723 4.38901C13.9623 4.29286 13.9444 4.15405 13.9133 3.99245C13.8486 3.65612 13.738 3.28098 13.5655 2.98506C13.3929 2.68905 13.1199 2.40608 12.8578 2.18185C12.7318 2.07412 12.6192 1.9891 12.54 1.93229C12.5006 1.90405 12.4701 1.88324 12.4511 1.87056L12.4319 1.85783L12.4295 1.85628L12.4319 1.85783C11.9619 1.56168 11.8233 0.944279 12.1221 0.478656Z"
                fill="#214EB0"/>
          <path fill-rule="evenodd" clip-rule="evenodd"
                d="M6.1182 9.78549C6.36676 10.1911 6.88016 10.375 7.34289 10.1984C9.15732 9.50593 11.0525 9.36643 12.4063 9.3872C13.1915 9.39924 13.7796 8.91315 14.0632 8.38966C14.348 7.86402 14.4351 7.09051 13.9418 6.44694C13.3516 5.677 12.6888 4.76138 12.2503 4.00891C11.7743 3.19226 11.2492 2.03091 10.844 1.07197C10.544 0.361857 9.87019 0.0328627 9.27146 0.0024049C8.67527 -0.0279242 7.98316 0.226747 7.59925 0.872692C6.92836 2.00146 5.83633 3.59613 4.35486 4.99805L1.74754 6.48909C1.08938 6.86546 0.726297 7.55366 0.738669 8.25651C0.658564 8.27864 0.579938 8.311 0.504591 8.35409C0.0220678 8.63003 -0.143257 9.24117 0.135328 9.71911L1.14417 11.4499C1.42276 11.9278 2.03976 12.0916 2.52228 11.8156C2.59953 11.7715 2.66865 11.7187 2.72912 11.6593C3.16143 11.9129 3.68043 12.0009 4.17936 11.8957C5.06452 13.1995 6.00526 14.1379 6.77231 14.7757C7.2266 15.1534 7.62067 15.4263 7.90759 15.6079C8.05112 15.6988 8.16806 15.767 8.25261 15.8142C8.2949 15.8378 8.32911 15.8562 8.35453 15.8695L8.38598 15.8858L8.3966 15.8912L8.40061 15.8932L8.40228 15.894L8.40373 15.8947C8.40373 15.8947 8.40465 15.8933 8.46034 15.7828C8.91805 14.8741 8.81204 15.0849 8.40373 15.8947C8.5437 15.964 8.69801 16 8.85447 16C10.0615 16 10.9481 15.2188 11.4422 14.6595C11.7078 14.3588 11.9127 14.0629 12.0508 13.8441C12.1205 13.7337 12.1748 13.6402 12.2129 13.5721C12.232 13.5379 12.2471 13.5099 12.2581 13.4892L12.2716 13.4634L12.276 13.4548L12.2777 13.4516L12.2789 13.4491C12.4185 13.1727 12.421 12.8478 12.2858 12.5693C12.1506 12.2907 11.8929 12.0898 11.5878 12.0251C10.5641 11.808 10.052 11.4608 9.81308 11.2404C9.69087 11.1276 9.62829 11.0373 9.60171 10.9935C9.59453 10.9817 9.58977 10.973 9.58706 10.9677C9.40126 10.471 8.85222 10.2014 8.33684 10.363C7.80565 10.5295 7.51135 11.0911 7.67951 11.6172C9.28515 11.1138 7.67924 11.6164 7.68001 11.6188L7.68053 11.6204L7.68159 11.6237L7.68387 11.6306L7.68906 11.6457C7.69281 11.6565 7.69714 11.6684 7.7021 11.6814C7.71204 11.7076 7.72453 11.7382 7.74005 11.7729C7.77111 11.8422 7.81424 11.9275 7.87309 12.0243C7.99126 12.2187 8.17076 12.4563 8.43787 12.7028C8.75391 12.9943 9.17826 13.2853 9.7432 13.5331C9.5047 13.7641 9.27498 13.9092 9.06708 13.9694C9.04424 13.9554 9.01994 13.9403 8.99425 13.924C8.77322 13.7841 8.45052 13.5617 8.06955 13.245C7.3077 12.6115 6.31563 11.6029 5.43471 10.1215C5.29864 9.89265 5.07623 9.72689 4.81657 9.66079C4.55691 9.59468 4.28137 9.63367 4.05078 9.76914L3.75927 9.9404L2.75639 8.21986L4.52496 7.20847L6.06772 9.71119C6.08359 9.73693 6.10044 9.7617 6.1182 9.78549ZM6.16572 6.03511L7.41365 8.05954C9.14909 7.52449 10.8488 7.38848 12.1303 7.38677C11.575 6.65116 10.9514 5.77763 10.5029 5.00809C10.0254 4.18886 9.53119 3.11793 9.14046 2.21278C8.47151 3.29716 7.47733 4.7095 6.16572 6.03511Z"
                fill="#214EB0"/>
          <path
              d="M12.8101 3.47239C13.2291 4.17912 13.1793 4.97859 12.6989 5.25806C12.2184 5.53752 11.4893 5.19116 11.0703 4.48443C10.6513 3.7777 10.7011 2.97823 11.1815 2.69876C11.662 2.4193 12.3911 2.76566 12.8101 3.47239Z"
              fill="#214EB0"/>
        </svg>

      </div>
      <div class="text">
        Следить за новостями компании
      </div>

    </div>
  </div>
</template>
<script>
export default {
  name: 'EmployerJournalSubscription',
  props: {
    employer: Object,
  },
  data() {
    return {
      isSubscribed: false,
      queryParams: {
        type: 1,
      },
    };
  },
  mounted() {
    this.isSubscribed = this.employer.subscriptions?.journal || false;
  },
  computed: {
    subscriptionEndpoint() {
      return `${process.env.VUE_APP_DEFAULT_DEVELOP_HOST}api/employer/${this.employer.id}/subscription`;
    },
    userCanSubscribe() {
      return this.$user?.type === 1;
    },
  },
  methods: {
    subscribe() {
      this.$http.post(this.subscriptionEndpoint, this.queryParams).then(() => {
        this.isSubscribed = true;
      });
    },
    unsubscribe() {
      this.$http.delete(this.subscriptionEndpoint, {params: this.queryParams}).then(() => {
        this.isSubscribed = false;
      });
    },
  },
};
</script>

<style scoped>
.container {
  display: flex;
  margin-bottom: 18px;
  cursor: pointer;
  margin-top: 36px;
}

.icon {
  margin-right: 8px;
}

.text {
  font-style: normal;
  font-weight: 500;
  font-size: 16px;
  line-height: 20px;
  color: #214EB0;
}
</style>